graph TB
    subgraph DB["ğŸ’¾ DATABASE - Neon PostgreSQL"]
        JOB_TABLE[("Job Table<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ id: UUID<br/>â€¢ title: String<br/>â€¢ description: Text<br/>â€¢ requirements: Text<br/>â€¢ responsibilities: Text<br/>â€¢ location: String<br/>â€¢ isRemote: Boolean<br/>â€¢ experienceLevel: String<br/>â€¢ requiredDegree: String<br/>â€¢ preferredDegree: String<br/>â€¢ requiredField: String<br/>â€¢ status: JobStatus<br/>â€¢ deadline: DateTime<br/>â€¢ publishedAt: DateTime")]
        
        JOB_SKILLS[("JobSkill Table<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ jobId: UUID<br/>â€¢ skillId: UUID<br/>â€¢ isRequired: Boolean")]
        
        SKILL_TABLE[("Skill Table<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ id: UUID<br/>â€¢ name: String<br/>â€¢ iconUrl: String")]
        
        COMPANY_TABLE[("Company Table<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â€¢ id: UUID<br/>â€¢ name: String<br/>â€¢ logoUrl: String")]
    end
    
    subgraph ORM["ğŸ”§ PRISMA ORM"]
        PRISMA_CLIENT["Prisma Client<br/>prisma.job.findMany()<br/>prisma.job.findUnique()"]
        
        QUERY1["Query 1: Find Matching Jobs<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>WHERE:<br/>â€¢ status = 'PUBLISHED'<br/>â€¢ deadline >= today<br/>â€¢ id NOT IN appliedJobs<br/>INCLUDE:<br/>â€¢ skills (with skill details)<br/>â€¢ company (name only)<br/>ORDER BY: publishedAt DESC<br/>TAKE: 200 jobs"]
        
        QUERY2["Query 2: Find Specific Job<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>WHERE:<br/>â€¢ id = jobId<br/>INCLUDE:<br/>â€¢ skills (with skill details)<br/>â€¢ company (name only)"]
    end
    
    subgraph SERVICE["âš™ï¸ MATCHING SERVICE"]
        FUNC1["findMatchingJobsForCandidate()<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Input: candidateId<br/>Output: MatchResult[]"]
        
        FUNC2["findMatchingCandidatesForJob()<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Input: jobId<br/>Output: MatchResult[]"]
        
        FUNC3["calculateCandidateJobMatch()<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Input: candidateId, jobId<br/>Output: MatchResult"]
        
        PREPARE["Prepare Job Data<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Extract from Prisma result:<br/>â€¢ title<br/>â€¢ description<br/>â€¢ requirements<br/>â€¢ responsibilities<br/>â€¢ skills (with isRequired flag)<br/>â€¢ experienceLevel<br/>â€¢ location<br/>â€¢ isRemote<br/>â€¢ requiredDegree<br/>â€¢ preferredDegree<br/>â€¢ requiredField"]
    end
    
    subgraph SCORING["ğŸ“Š SCORING ALGORITHM"]
        CALC["calculateMatchScore()<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Input:<br/>â€¢ candidateData<br/>â€¢ jobData<br/>Output:<br/>â€¢ matchScore (0-100)<br/>â€¢ breakdown<br/>â€¢ details"]
        
        DIM1["Dimension 1: Skills<br/>Uses: jobData.skills"]
        DIM2["Dimension 2: Experience<br/>Uses: jobData.experienceLevel"]
        DIM3["Dimension 3: Title<br/>Uses: jobData.title"]
        DIM4["Dimension 4: Education<br/>Uses: jobData.requiredDegree,<br/>preferredDegree, requiredField"]
        DIM5["Dimension 5: Soft Skills<br/>Uses: jobData.description,<br/>requirements, responsibilities<br/>(extracted via NLP)"]
        DIM6["Dimension 6: Technology<br/>Uses: jobData.description,<br/>requirements<br/>(extracted via NLP)"]
        DIM7["Dimension 7: Location<br/>Uses: jobData.location,<br/>jobData.isRemote"]
    end
    
    subgraph API["ğŸŒ API ROUTES"]
        ROUTE1["GET /matching/candidate/:id/jobs<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Calls: findMatchingJobsForCandidate()"]
        
        ROUTE2["GET /matching/job/:id/candidates<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Calls: findMatchingCandidatesForJob()"]
        
        ROUTE3["GET /matching/candidate/:cId/job/:jId<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>Calls: calculateCandidateJobMatch()"]
    end
    
    %% Database Relations
    JOB_TABLE -->|1:N| JOB_SKILLS
    JOB_SKILLS -->|N:1| SKILL_TABLE
    JOB_TABLE -->|N:1| COMPANY_TABLE
    
    %% ORM Queries
    PRISMA_CLIENT -->|Executes| QUERY1
    PRISMA_CLIENT -->|Executes| QUERY2
    QUERY1 -->|Fetches| JOB_TABLE
    QUERY1 -->|Includes| JOB_SKILLS
    QUERY1 -->|Includes| SKILL_TABLE
    QUERY1 -->|Includes| COMPANY_TABLE
    QUERY2 -->|Fetches| JOB_TABLE
    QUERY2 -->|Includes| JOB_SKILLS
    QUERY2 -->|Includes| SKILL_TABLE
    QUERY2 -->|Includes| COMPANY_TABLE
    
    %% Service Functions
    FUNC1 -->|Uses| QUERY1
    FUNC2 -->|Uses| QUERY2
    FUNC3 -->|Uses| QUERY2
    FUNC1 -->|Prepares| PREPARE
    FUNC2 -->|Prepares| PREPARE
    FUNC3 -->|Prepares| PREPARE
    
    %% Scoring
    PREPARE -->|Passes jobData| CALC
    CALC -->|Uses| DIM1
    CALC -->|Uses| DIM2
    CALC -->|Uses| DIM3
    CALC -->|Uses| DIM4
    CALC -->|Uses| DIM5
    CALC -->|Uses| DIM6
    CALC -->|Uses| DIM7
    
    %% API Routes
    ROUTE1 -->|Calls| FUNC1
    ROUTE2 -->|Calls| FUNC2
    ROUTE3 -->|Calls| FUNC3
    
    %% Styling
    classDef database fill:#336791,stroke:#fff,stroke-width:3px,color:#fff
    classDef orm fill:#2d3748,stroke:#fff,stroke-width:2px,color:#fff
    classDef service fill:#00d8ff,stroke:#20232a,stroke-width:2px,color:#000
    classDef scoring fill:#51cf66,stroke:#fff,stroke-width:2px,color:#000
    classDef api fill:#61dafb,stroke:#20232a,stroke-width:2px,color:#000
    
    class JOB_TABLE,JOB_SKILLS,SKILL_TABLE,COMPANY_TABLE,DB database
    class PRISMA_CLIENT,QUERY1,QUERY2,ORM orm
    class FUNC1,FUNC2,FUNC3,PREPARE,SERVICE service
    class CALC,DIM1,DIM2,DIM3,DIM4,DIM5,DIM6,DIM7,SCORING scoring
    class ROUTE1,ROUTE2,ROUTE3,API api

