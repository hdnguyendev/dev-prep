name = "dev-prep-api"
main = "src/worker.ts"
compatibility_date = "2025-12-14"
compatibility_flags = ["nodejs_compat"]

# Environment variables (set via dashboard or CLI)
[vars]
NODE_ENV = "production"

# For Prisma with external PostgreSQL (Neon/Supabase recommended)
# Set these via: wrangler secret put <KEY_NAME>
# - DATABASE_URL (PostgreSQL connection string with connection pooling)
# - CLERK_PUBLISHABLE_KEY
# - CLERK_SECRET_KEY
# - JWT_SECRET

# Hyperdrive Configuration (Recommended for Cloudflare Workers + Neon)
[[hyperdrive]]
binding = "HYPERDRIVE"
id = "0649b0dceee14c3ca11c88bc066e7297"

# R2 Bucket for file uploads (resumes, etc.)
# 
# SETUP INSTRUCTIONS:
# 1. Enable R2 in Cloudflare Dashboard: https://dash.cloudflare.com → R2 → Get Started
# 2. Create bucket: wrangler r2 bucket create dev-prep-uploads
# 3. Uncomment the binding below:
#
# [[r2_buckets]]
# binding = "R2_STORAGE"
# bucket_name = "dev-prep-uploads"

# Worker settings
workers_dev = true
route = { pattern = "api.dev-prep.com/*", zone_name = "dev-prep.com" }

# Increase memory and CPU limits for Prisma
[placement]
mode = "smart"

# Observability
[observability]
enabled = true
head_sampling_rate = 1
